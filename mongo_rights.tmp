user {
    _id : ... ,
    mail : "buk@buk.buk",
    groups : ["miogo", "fauteuil", "support"]
}

folder { 
    _id : ...,
    files : [
        ...
    ],
    rights : {
        all : [r, w],
        groups : [
        {name : "miogo", rights : [r, w]},
        {name : "fauteuil", rights : [r]},
        ],
        users : [
        {name : "fourni@fournix.fr", rights : [r, w]},
        {name : "buk@buk.buk", rights : [r]}
        ]
    }
}

file { 
    _id : ...,
    name : "naufrage.png"
    rights : {
        all : [r, w],
        groups : [
        {name : "fauteuil", rights : [r]},
        ],
        users : [
        {name : "fourni@fournix.fr", rights : [r, w]},
        ]
    }
}

group {
    _id : ...,
    name : "miogo",
    idAdmin : ...
}



        if name == "all" {
            return mdb.db.C("folders").Update(
                bson.M{"path": resource, "files.name": filename},
                bson.M{"$addToSet":
                    bson.M{"files.0.rights":
                        bson.M{"all": rights}
                    }
                }
            )
        } else {
            return mdb.db.C("folders").Update(
                bson.M{"path": path, "files.name": filename},
                bson.M{"$push":
                    bson.M{"files.0.rights":
                        bson.M{entityType :
                            bson.M{name: rights}
                        }
                    }
                }
            )
        }
    } else {
        if name == "all" {
            return mdb.db.C("folders").Update(
                bson.M{"path": resource},
                bson.M{"$addToSet":
                    bson.M{"rights":
                        bson.M{"all": rights}
                    }
                }
            )
        } else {
            return mdb.db.C("folders").Update(
                bson.M{"path": resource},
                bson.M{"$addToSet":
                    bson.M{"rights":
                        bson.M{entityType:
                            bson.M{name: rights}
                        }
                    }
                }
            )
        }
    }